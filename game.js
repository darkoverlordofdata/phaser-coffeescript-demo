(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
// Generated by CoffeeScript 1.6.3
var Boot, _ref,
  __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

Phaser.State.prototype.constructor = Phaser.State;

module.exports = Boot = (function(_super) {
  __extends(Boot, _super);

  function Boot() {
    _ref = Boot.__super__.constructor.apply(this, arguments);
    return _ref;
  }

  Boot.prototype.preload = function() {
    return this.load.image('preloadBar', 'assets/loader.png');
  };

  Boot.prototype.create = function() {
    this.input.maxPointers = 1;
    this.stage.disableVisibilityChange = true;
    if (this.game.device.desktop) {
      this.stage.scale.pageAlignHorizontally = true;
    } else {

    }
    return this.game.state.start('Preloader', true, false);
  };

  return Boot;

})(Phaser.State);

},{}],2:[function(require,module,exports){
// Generated by CoffeeScript 1.6.3
var Game,
  __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

Phaser.Game.prototype.constructor = Phaser.Game;

module.exports = Game = (function(_super) {
  __extends(Game, _super);

  function Game() {
    Game.__super__.constructor.call(this, 800, 600, Phaser.AUTO, 'content', null);
    this.state.add('Boot', require("./Boot"), false);
    this.state.add('Preloader', require("./Preloader"), false);
    this.state.add('MainMenu', require("./MainMenu"), false);
    this.state.add('Level1', require("./Level1"), false);
    this.state.start('Boot');
  }

  return Game;

})(Phaser.Game);

},{"./Boot":1,"./Level1":3,"./MainMenu":4,"./Preloader":6}],3:[function(require,module,exports){
// Generated by CoffeeScript 1.6.3
var Level1, _ref,
  __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

Phaser.State.prototype.constructor = Phaser.State;

module.exports = Level1 = (function(_super) {
  var Player;

  __extends(Level1, _super);

  function Level1() {
    _ref = Level1.__super__.constructor.apply(this, arguments);
    return _ref;
  }

  Player = require("./Player");

  Level1.prototype.background = Phaser.Sprite;

  Level1.prototype.music = Phaser.Sound;

  Level1.prototype.player = Player;

  Level1.prototype.create = function() {
    this.background = this.add.sprite(0, 0, 'level1');
    this.music = this.add.audio('music', 1, false);
    this.music.play();
    return this.player = new Player(this.game, 130, 284);
  };

  return Level1;

})(Phaser.State);

},{"./Player":5}],4:[function(require,module,exports){
// Generated by CoffeeScript 1.6.3
var MainMenu, _ref,
  __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

Phaser.State.prototype.constructor = Phaser.State;

module.exports = MainMenu = (function(_super) {
  __extends(MainMenu, _super);

  function MainMenu() {
    _ref = MainMenu.__super__.constructor.apply(this, arguments);
    return _ref;
  }

  MainMenu.prototype.background = Phaser.Sprite;

  MainMenu.prototype.logo = Phaser.Sprite;

  MainMenu.prototype.create = function() {
    this.background = this.add.sprite(0, 0, 'titlepage');
    this.background.alpha = 0;
    this.logo = this.add.sprite(this.world.centerX, -300, 'logo');
    this.logo.anchor.setTo(0.5, 0.5);
    this.add.tween(this.background).to({
      alpha: 1
    }, 2000, Phaser.Easing.Bounce.InOut, true);
    this.add.tween(this.logo).to({
      y: 220
    }, 2000, Phaser.Easing.Elastic.Out, true, 2000);
    return this.input.onDown.addOnce(this.fadeOut, this);
  };

  MainMenu.prototype.fadeOut = function() {
    var tween;
    this.add.tween(this.background).to({
      alpha: 0
    }, 2000, Phaser.Easing.Linear.None, true);
    tween = this.add.tween(this.logo).to({
      y: 800
    }, 2000, Phaser.Easing.Linear.None, true);
    return tween.onComplete.add(this.startGame, this);
  };

  MainMenu.prototype.startGame = function() {
    return this.game.state.start('Level1', true, false);
  };

  return MainMenu;

})(Phaser.State);

},{}],5:[function(require,module,exports){
// Generated by CoffeeScript 1.6.3
var Player,
  __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

Phaser.Sprite.prototype.constructor = Phaser.Sprite;

module.exports = Player = (function(_super) {
  __extends(Player, _super);

  function Player(game, x, y) {
    Player.__super__.constructor.call(this, game, x, y, 'simon', 0);
    this.anchor.setTo(0.5, 0);
    this.animations.add('walk', [0, 1, 2, 3, 4], 10, true);
    game.add.existing(this);
  }

  Player.prototype.update = function() {
    this.body.velocity.x = 0;
    if (this.game.input.keyboard.isDown(Phaser.Keyboard.LEFT)) {
      this.body.velocity.x = -150;
      this.animations.play('walk');
      if (this.scale.x === 1) {
        return this.scale.x = -1;
      }
    } else if (this.game.input.keyboard.isDown(Phaser.Keyboard.RIGHT)) {
      this.body.velocity.x = 150;
      this.animations.play('walk');
      if (this.scale.x === -1) {
        return this.scale.x = 1;
      }
    } else {
      return this.animations.frame = 0;
    }
  };

  return Player;

})(Phaser.Sprite);

},{}],6:[function(require,module,exports){
// Generated by CoffeeScript 1.6.3
var Preloader, _ref,
  __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

Phaser.State.prototype.constructor = Phaser.State;

module.exports = Preloader = (function(_super) {
  __extends(Preloader, _super);

  function Preloader() {
    _ref = Preloader.__super__.constructor.apply(this, arguments);
    return _ref;
  }

  Preloader.prototype.preloadBar = Phaser.Sprite;

  Preloader.prototype.preload = function() {
    this.preloadBar = this.add.sprite(200, 250, 'preloadBar');
    this.load.setPreloadSprite(this.preloadBar);
    this.load.image('titlepage', 'assets/titlepage.jpg');
    this.load.image('logo', 'assets/logo.png');
    this.load.audio('music', 'assets/title.mp3', true);
    this.load.spritesheet('simon', 'assets/simon.png', 58, 96, 5);
    return this.load.image('level1', 'assets/level1.png');
  };

  Preloader.prototype.create = function() {
    var tween;
    tween = this.add.tween(this.preloadBar).to({
      alpha: 0
    }, 1000, Phaser.Easing.Linear.None, true);
    return tween.onComplete.add(this.startMainMenu, this);
  };

  Preloader.prototype.startMainMenu = function() {
    return this.game.state.start('MainMenu', true, false);
  };

  return Preloader;

})(Phaser.State);

},{}],7:[function(require,module,exports){
// Generated by CoffeeScript 1.6.3
window.onload = function() {
  var Game;
  Game = require('./Game');
  return new Game;
};

},{"./Game":2}]},{},[7])
//@ sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlcyI6WyIvaG9tZS9icnVjZS9HaXQvcGhhc2VyLWNvZmZlZXNjcmlwdC1kZW1vL2pzL0Jvb3QuanMiLCIvaG9tZS9icnVjZS9HaXQvcGhhc2VyLWNvZmZlZXNjcmlwdC1kZW1vL2pzL0dhbWUuanMiLCIvaG9tZS9icnVjZS9HaXQvcGhhc2VyLWNvZmZlZXNjcmlwdC1kZW1vL2pzL0xldmVsMS5qcyIsIi9ob21lL2JydWNlL0dpdC9waGFzZXItY29mZmVlc2NyaXB0LWRlbW8vanMvTWFpbk1lbnUuanMiLCIvaG9tZS9icnVjZS9HaXQvcGhhc2VyLWNvZmZlZXNjcmlwdC1kZW1vL2pzL1BsYXllci5qcyIsIi9ob21lL2JydWNlL0dpdC9waGFzZXItY29mZmVlc2NyaXB0LWRlbW8vanMvUHJlbG9hZGVyLmpzIiwiL2hvbWUvYnJ1Y2UvR2l0L3BoYXNlci1jb2ZmZWVzY3JpcHQtZGVtby9qcy9hcHAuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25EQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlc0NvbnRlbnQiOlsiLy8gR2VuZXJhdGVkIGJ5IENvZmZlZVNjcmlwdCAxLjYuM1xudmFyIEJvb3QsIF9yZWYsXG4gIF9faGFzUHJvcCA9IHt9Lmhhc093blByb3BlcnR5LFxuICBfX2V4dGVuZHMgPSBmdW5jdGlvbihjaGlsZCwgcGFyZW50KSB7IGZvciAodmFyIGtleSBpbiBwYXJlbnQpIHsgaWYgKF9faGFzUHJvcC5jYWxsKHBhcmVudCwga2V5KSkgY2hpbGRba2V5XSA9IHBhcmVudFtrZXldOyB9IGZ1bmN0aW9uIGN0b3IoKSB7IHRoaXMuY29uc3RydWN0b3IgPSBjaGlsZDsgfSBjdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7IGNoaWxkLnByb3RvdHlwZSA9IG5ldyBjdG9yKCk7IGNoaWxkLl9fc3VwZXJfXyA9IHBhcmVudC5wcm90b3R5cGU7IHJldHVybiBjaGlsZDsgfTtcblxuUGhhc2VyLlN0YXRlLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFBoYXNlci5TdGF0ZTtcblxubW9kdWxlLmV4cG9ydHMgPSBCb290ID0gKGZ1bmN0aW9uKF9zdXBlcikge1xuICBfX2V4dGVuZHMoQm9vdCwgX3N1cGVyKTtcblxuICBmdW5jdGlvbiBCb290KCkge1xuICAgIF9yZWYgPSBCb290Ll9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIHJldHVybiBfcmVmO1xuICB9XG5cbiAgQm9vdC5wcm90b3R5cGUucHJlbG9hZCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmxvYWQuaW1hZ2UoJ3ByZWxvYWRCYXInLCAnYXNzZXRzL2xvYWRlci5wbmcnKTtcbiAgfTtcblxuICBCb290LnByb3RvdHlwZS5jcmVhdGUgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmlucHV0Lm1heFBvaW50ZXJzID0gMTtcbiAgICB0aGlzLnN0YWdlLmRpc2FibGVWaXNpYmlsaXR5Q2hhbmdlID0gdHJ1ZTtcbiAgICBpZiAodGhpcy5nYW1lLmRldmljZS5kZXNrdG9wKSB7XG4gICAgICB0aGlzLnN0YWdlLnNjYWxlLnBhZ2VBbGlnbkhvcml6b250YWxseSA9IHRydWU7XG4gICAgfSBlbHNlIHtcblxuICAgIH1cbiAgICByZXR1cm4gdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdQcmVsb2FkZXInLCB0cnVlLCBmYWxzZSk7XG4gIH07XG5cbiAgcmV0dXJuIEJvb3Q7XG5cbn0pKFBoYXNlci5TdGF0ZSk7XG4iLCIvLyBHZW5lcmF0ZWQgYnkgQ29mZmVlU2NyaXB0IDEuNi4zXG52YXIgR2FtZSxcbiAgX19oYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHksXG4gIF9fZXh0ZW5kcyA9IGZ1bmN0aW9uKGNoaWxkLCBwYXJlbnQpIHsgZm9yICh2YXIga2V5IGluIHBhcmVudCkgeyBpZiAoX19oYXNQcm9wLmNhbGwocGFyZW50LCBrZXkpKSBjaGlsZFtrZXldID0gcGFyZW50W2tleV07IH0gZnVuY3Rpb24gY3RvcigpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGNoaWxkOyB9IGN0b3IucHJvdG90eXBlID0gcGFyZW50LnByb3RvdHlwZTsgY2hpbGQucHJvdG90eXBlID0gbmV3IGN0b3IoKTsgY2hpbGQuX19zdXBlcl9fID0gcGFyZW50LnByb3RvdHlwZTsgcmV0dXJuIGNoaWxkOyB9O1xuXG5QaGFzZXIuR2FtZS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBQaGFzZXIuR2FtZTtcblxubW9kdWxlLmV4cG9ydHMgPSBHYW1lID0gKGZ1bmN0aW9uKF9zdXBlcikge1xuICBfX2V4dGVuZHMoR2FtZSwgX3N1cGVyKTtcblxuICBmdW5jdGlvbiBHYW1lKCkge1xuICAgIEdhbWUuX19zdXBlcl9fLmNvbnN0cnVjdG9yLmNhbGwodGhpcywgODAwLCA2MDAsIFBoYXNlci5BVVRPLCAnY29udGVudCcsIG51bGwpO1xuICAgIHRoaXMuc3RhdGUuYWRkKCdCb290JywgcmVxdWlyZShcIi4vQm9vdFwiKSwgZmFsc2UpO1xuICAgIHRoaXMuc3RhdGUuYWRkKCdQcmVsb2FkZXInLCByZXF1aXJlKFwiLi9QcmVsb2FkZXJcIiksIGZhbHNlKTtcbiAgICB0aGlzLnN0YXRlLmFkZCgnTWFpbk1lbnUnLCByZXF1aXJlKFwiLi9NYWluTWVudVwiKSwgZmFsc2UpO1xuICAgIHRoaXMuc3RhdGUuYWRkKCdMZXZlbDEnLCByZXF1aXJlKFwiLi9MZXZlbDFcIiksIGZhbHNlKTtcbiAgICB0aGlzLnN0YXRlLnN0YXJ0KCdCb290Jyk7XG4gIH1cblxuICByZXR1cm4gR2FtZTtcblxufSkoUGhhc2VyLkdhbWUpO1xuIiwiLy8gR2VuZXJhdGVkIGJ5IENvZmZlZVNjcmlwdCAxLjYuM1xudmFyIExldmVsMSwgX3JlZixcbiAgX19oYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHksXG4gIF9fZXh0ZW5kcyA9IGZ1bmN0aW9uKGNoaWxkLCBwYXJlbnQpIHsgZm9yICh2YXIga2V5IGluIHBhcmVudCkgeyBpZiAoX19oYXNQcm9wLmNhbGwocGFyZW50LCBrZXkpKSBjaGlsZFtrZXldID0gcGFyZW50W2tleV07IH0gZnVuY3Rpb24gY3RvcigpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGNoaWxkOyB9IGN0b3IucHJvdG90eXBlID0gcGFyZW50LnByb3RvdHlwZTsgY2hpbGQucHJvdG90eXBlID0gbmV3IGN0b3IoKTsgY2hpbGQuX19zdXBlcl9fID0gcGFyZW50LnByb3RvdHlwZTsgcmV0dXJuIGNoaWxkOyB9O1xuXG5QaGFzZXIuU3RhdGUucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gUGhhc2VyLlN0YXRlO1xuXG5tb2R1bGUuZXhwb3J0cyA9IExldmVsMSA9IChmdW5jdGlvbihfc3VwZXIpIHtcbiAgdmFyIFBsYXllcjtcblxuICBfX2V4dGVuZHMoTGV2ZWwxLCBfc3VwZXIpO1xuXG4gIGZ1bmN0aW9uIExldmVsMSgpIHtcbiAgICBfcmVmID0gTGV2ZWwxLl9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIHJldHVybiBfcmVmO1xuICB9XG5cbiAgUGxheWVyID0gcmVxdWlyZShcIi4vUGxheWVyXCIpO1xuXG4gIExldmVsMS5wcm90b3R5cGUuYmFja2dyb3VuZCA9IFBoYXNlci5TcHJpdGU7XG5cbiAgTGV2ZWwxLnByb3RvdHlwZS5tdXNpYyA9IFBoYXNlci5Tb3VuZDtcblxuICBMZXZlbDEucHJvdG90eXBlLnBsYXllciA9IFBsYXllcjtcblxuICBMZXZlbDEucHJvdG90eXBlLmNyZWF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuYmFja2dyb3VuZCA9IHRoaXMuYWRkLnNwcml0ZSgwLCAwLCAnbGV2ZWwxJyk7XG4gICAgdGhpcy5tdXNpYyA9IHRoaXMuYWRkLmF1ZGlvKCdtdXNpYycsIDEsIGZhbHNlKTtcbiAgICB0aGlzLm11c2ljLnBsYXkoKTtcbiAgICByZXR1cm4gdGhpcy5wbGF5ZXIgPSBuZXcgUGxheWVyKHRoaXMuZ2FtZSwgMTMwLCAyODQpO1xuICB9O1xuXG4gIHJldHVybiBMZXZlbDE7XG5cbn0pKFBoYXNlci5TdGF0ZSk7XG4iLCIvLyBHZW5lcmF0ZWQgYnkgQ29mZmVlU2NyaXB0IDEuNi4zXG52YXIgTWFpbk1lbnUsIF9yZWYsXG4gIF9faGFzUHJvcCA9IHt9Lmhhc093blByb3BlcnR5LFxuICBfX2V4dGVuZHMgPSBmdW5jdGlvbihjaGlsZCwgcGFyZW50KSB7IGZvciAodmFyIGtleSBpbiBwYXJlbnQpIHsgaWYgKF9faGFzUHJvcC5jYWxsKHBhcmVudCwga2V5KSkgY2hpbGRba2V5XSA9IHBhcmVudFtrZXldOyB9IGZ1bmN0aW9uIGN0b3IoKSB7IHRoaXMuY29uc3RydWN0b3IgPSBjaGlsZDsgfSBjdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7IGNoaWxkLnByb3RvdHlwZSA9IG5ldyBjdG9yKCk7IGNoaWxkLl9fc3VwZXJfXyA9IHBhcmVudC5wcm90b3R5cGU7IHJldHVybiBjaGlsZDsgfTtcblxuUGhhc2VyLlN0YXRlLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFBoYXNlci5TdGF0ZTtcblxubW9kdWxlLmV4cG9ydHMgPSBNYWluTWVudSA9IChmdW5jdGlvbihfc3VwZXIpIHtcbiAgX19leHRlbmRzKE1haW5NZW51LCBfc3VwZXIpO1xuXG4gIGZ1bmN0aW9uIE1haW5NZW51KCkge1xuICAgIF9yZWYgPSBNYWluTWVudS5fX3N1cGVyX18uY29uc3RydWN0b3IuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICByZXR1cm4gX3JlZjtcbiAgfVxuXG4gIE1haW5NZW51LnByb3RvdHlwZS5iYWNrZ3JvdW5kID0gUGhhc2VyLlNwcml0ZTtcblxuICBNYWluTWVudS5wcm90b3R5cGUubG9nbyA9IFBoYXNlci5TcHJpdGU7XG5cbiAgTWFpbk1lbnUucHJvdG90eXBlLmNyZWF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuYmFja2dyb3VuZCA9IHRoaXMuYWRkLnNwcml0ZSgwLCAwLCAndGl0bGVwYWdlJyk7XG4gICAgdGhpcy5iYWNrZ3JvdW5kLmFscGhhID0gMDtcbiAgICB0aGlzLmxvZ28gPSB0aGlzLmFkZC5zcHJpdGUodGhpcy53b3JsZC5jZW50ZXJYLCAtMzAwLCAnbG9nbycpO1xuICAgIHRoaXMubG9nby5hbmNob3Iuc2V0VG8oMC41LCAwLjUpO1xuICAgIHRoaXMuYWRkLnR3ZWVuKHRoaXMuYmFja2dyb3VuZCkudG8oe1xuICAgICAgYWxwaGE6IDFcbiAgICB9LCAyMDAwLCBQaGFzZXIuRWFzaW5nLkJvdW5jZS5Jbk91dCwgdHJ1ZSk7XG4gICAgdGhpcy5hZGQudHdlZW4odGhpcy5sb2dvKS50byh7XG4gICAgICB5OiAyMjBcbiAgICB9LCAyMDAwLCBQaGFzZXIuRWFzaW5nLkVsYXN0aWMuT3V0LCB0cnVlLCAyMDAwKTtcbiAgICByZXR1cm4gdGhpcy5pbnB1dC5vbkRvd24uYWRkT25jZSh0aGlzLmZhZGVPdXQsIHRoaXMpO1xuICB9O1xuXG4gIE1haW5NZW51LnByb3RvdHlwZS5mYWRlT3V0ID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHR3ZWVuO1xuICAgIHRoaXMuYWRkLnR3ZWVuKHRoaXMuYmFja2dyb3VuZCkudG8oe1xuICAgICAgYWxwaGE6IDBcbiAgICB9LCAyMDAwLCBQaGFzZXIuRWFzaW5nLkxpbmVhci5Ob25lLCB0cnVlKTtcbiAgICB0d2VlbiA9IHRoaXMuYWRkLnR3ZWVuKHRoaXMubG9nbykudG8oe1xuICAgICAgeTogODAwXG4gICAgfSwgMjAwMCwgUGhhc2VyLkVhc2luZy5MaW5lYXIuTm9uZSwgdHJ1ZSk7XG4gICAgcmV0dXJuIHR3ZWVuLm9uQ29tcGxldGUuYWRkKHRoaXMuc3RhcnRHYW1lLCB0aGlzKTtcbiAgfTtcblxuICBNYWluTWVudS5wcm90b3R5cGUuc3RhcnRHYW1lID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2FtZS5zdGF0ZS5zdGFydCgnTGV2ZWwxJywgdHJ1ZSwgZmFsc2UpO1xuICB9O1xuXG4gIHJldHVybiBNYWluTWVudTtcblxufSkoUGhhc2VyLlN0YXRlKTtcbiIsIi8vIEdlbmVyYXRlZCBieSBDb2ZmZWVTY3JpcHQgMS42LjNcbnZhciBQbGF5ZXIsXG4gIF9faGFzUHJvcCA9IHt9Lmhhc093blByb3BlcnR5LFxuICBfX2V4dGVuZHMgPSBmdW5jdGlvbihjaGlsZCwgcGFyZW50KSB7IGZvciAodmFyIGtleSBpbiBwYXJlbnQpIHsgaWYgKF9faGFzUHJvcC5jYWxsKHBhcmVudCwga2V5KSkgY2hpbGRba2V5XSA9IHBhcmVudFtrZXldOyB9IGZ1bmN0aW9uIGN0b3IoKSB7IHRoaXMuY29uc3RydWN0b3IgPSBjaGlsZDsgfSBjdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7IGNoaWxkLnByb3RvdHlwZSA9IG5ldyBjdG9yKCk7IGNoaWxkLl9fc3VwZXJfXyA9IHBhcmVudC5wcm90b3R5cGU7IHJldHVybiBjaGlsZDsgfTtcblxuUGhhc2VyLlNwcml0ZS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBQaGFzZXIuU3ByaXRlO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFBsYXllciA9IChmdW5jdGlvbihfc3VwZXIpIHtcbiAgX19leHRlbmRzKFBsYXllciwgX3N1cGVyKTtcblxuICBmdW5jdGlvbiBQbGF5ZXIoZ2FtZSwgeCwgeSkge1xuICAgIFBsYXllci5fX3N1cGVyX18uY29uc3RydWN0b3IuY2FsbCh0aGlzLCBnYW1lLCB4LCB5LCAnc2ltb24nLCAwKTtcbiAgICB0aGlzLmFuY2hvci5zZXRUbygwLjUsIDApO1xuICAgIHRoaXMuYW5pbWF0aW9ucy5hZGQoJ3dhbGsnLCBbMCwgMSwgMiwgMywgNF0sIDEwLCB0cnVlKTtcbiAgICBnYW1lLmFkZC5leGlzdGluZyh0aGlzKTtcbiAgfVxuXG4gIFBsYXllci5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5ib2R5LnZlbG9jaXR5LnggPSAwO1xuICAgIGlmICh0aGlzLmdhbWUuaW5wdXQua2V5Ym9hcmQuaXNEb3duKFBoYXNlci5LZXlib2FyZC5MRUZUKSkge1xuICAgICAgdGhpcy5ib2R5LnZlbG9jaXR5LnggPSAtMTUwO1xuICAgICAgdGhpcy5hbmltYXRpb25zLnBsYXkoJ3dhbGsnKTtcbiAgICAgIGlmICh0aGlzLnNjYWxlLnggPT09IDEpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NhbGUueCA9IC0xO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodGhpcy5nYW1lLmlucHV0LmtleWJvYXJkLmlzRG93bihQaGFzZXIuS2V5Ym9hcmQuUklHSFQpKSB7XG4gICAgICB0aGlzLmJvZHkudmVsb2NpdHkueCA9IDE1MDtcbiAgICAgIHRoaXMuYW5pbWF0aW9ucy5wbGF5KCd3YWxrJyk7XG4gICAgICBpZiAodGhpcy5zY2FsZS54ID09PSAtMSkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY2FsZS54ID0gMTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHRoaXMuYW5pbWF0aW9ucy5mcmFtZSA9IDA7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBQbGF5ZXI7XG5cbn0pKFBoYXNlci5TcHJpdGUpO1xuIiwiLy8gR2VuZXJhdGVkIGJ5IENvZmZlZVNjcmlwdCAxLjYuM1xudmFyIFByZWxvYWRlciwgX3JlZixcbiAgX19oYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHksXG4gIF9fZXh0ZW5kcyA9IGZ1bmN0aW9uKGNoaWxkLCBwYXJlbnQpIHsgZm9yICh2YXIga2V5IGluIHBhcmVudCkgeyBpZiAoX19oYXNQcm9wLmNhbGwocGFyZW50LCBrZXkpKSBjaGlsZFtrZXldID0gcGFyZW50W2tleV07IH0gZnVuY3Rpb24gY3RvcigpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGNoaWxkOyB9IGN0b3IucHJvdG90eXBlID0gcGFyZW50LnByb3RvdHlwZTsgY2hpbGQucHJvdG90eXBlID0gbmV3IGN0b3IoKTsgY2hpbGQuX19zdXBlcl9fID0gcGFyZW50LnByb3RvdHlwZTsgcmV0dXJuIGNoaWxkOyB9O1xuXG5QaGFzZXIuU3RhdGUucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gUGhhc2VyLlN0YXRlO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFByZWxvYWRlciA9IChmdW5jdGlvbihfc3VwZXIpIHtcbiAgX19leHRlbmRzKFByZWxvYWRlciwgX3N1cGVyKTtcblxuICBmdW5jdGlvbiBQcmVsb2FkZXIoKSB7XG4gICAgX3JlZiA9IFByZWxvYWRlci5fX3N1cGVyX18uY29uc3RydWN0b3IuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICByZXR1cm4gX3JlZjtcbiAgfVxuXG4gIFByZWxvYWRlci5wcm90b3R5cGUucHJlbG9hZEJhciA9IFBoYXNlci5TcHJpdGU7XG5cbiAgUHJlbG9hZGVyLnByb3RvdHlwZS5wcmVsb2FkID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5wcmVsb2FkQmFyID0gdGhpcy5hZGQuc3ByaXRlKDIwMCwgMjUwLCAncHJlbG9hZEJhcicpO1xuICAgIHRoaXMubG9hZC5zZXRQcmVsb2FkU3ByaXRlKHRoaXMucHJlbG9hZEJhcik7XG4gICAgdGhpcy5sb2FkLmltYWdlKCd0aXRsZXBhZ2UnLCAnYXNzZXRzL3RpdGxlcGFnZS5qcGcnKTtcbiAgICB0aGlzLmxvYWQuaW1hZ2UoJ2xvZ28nLCAnYXNzZXRzL2xvZ28ucG5nJyk7XG4gICAgdGhpcy5sb2FkLmF1ZGlvKCdtdXNpYycsICdhc3NldHMvdGl0bGUubXAzJywgdHJ1ZSk7XG4gICAgdGhpcy5sb2FkLnNwcml0ZXNoZWV0KCdzaW1vbicsICdhc3NldHMvc2ltb24ucG5nJywgNTgsIDk2LCA1KTtcbiAgICByZXR1cm4gdGhpcy5sb2FkLmltYWdlKCdsZXZlbDEnLCAnYXNzZXRzL2xldmVsMS5wbmcnKTtcbiAgfTtcblxuICBQcmVsb2FkZXIucHJvdG90eXBlLmNyZWF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciB0d2VlbjtcbiAgICB0d2VlbiA9IHRoaXMuYWRkLnR3ZWVuKHRoaXMucHJlbG9hZEJhcikudG8oe1xuICAgICAgYWxwaGE6IDBcbiAgICB9LCAxMDAwLCBQaGFzZXIuRWFzaW5nLkxpbmVhci5Ob25lLCB0cnVlKTtcbiAgICByZXR1cm4gdHdlZW4ub25Db21wbGV0ZS5hZGQodGhpcy5zdGFydE1haW5NZW51LCB0aGlzKTtcbiAgfTtcblxuICBQcmVsb2FkZXIucHJvdG90eXBlLnN0YXJ0TWFpbk1lbnUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdNYWluTWVudScsIHRydWUsIGZhbHNlKTtcbiAgfTtcblxuICByZXR1cm4gUHJlbG9hZGVyO1xuXG59KShQaGFzZXIuU3RhdGUpO1xuIiwiLy8gR2VuZXJhdGVkIGJ5IENvZmZlZVNjcmlwdCAxLjYuM1xud2luZG93Lm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuICB2YXIgR2FtZTtcbiAgR2FtZSA9IHJlcXVpcmUoJy4vR2FtZScpO1xuICByZXR1cm4gbmV3IEdhbWU7XG59O1xuIl19
